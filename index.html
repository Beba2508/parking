<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parking Management</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            text-align: center; 
            background: linear-gradient(to right, #141e30, #243b55);
            color: white; 
            padding: 20px; 
        }

        table { 
            width: 90%; 
            margin: auto; 
            border-collapse: collapse; 
            background: #1f2833; 
            border-radius: 8px; 
            overflow: hidden; 
        }

        th, td { 
            padding: 10px; 
            border: 1px solid #45a049; 
            text-align: center; 
            cursor: pointer; 
        }

        th { 
            background: #16a085; 
            color: white; 
        }

        .occupied { 
            background: red; 
            color: white; 
        }

        .available { 
            background: green; 
            color: white; 
        }

        .summary { 
            font-weight: bold; 
            background: #34495e; 
            color: white; 
        }

        button { 
            background: #ff4081; 
            color: white; 
            border: none; 
            padding: 10px; 
            border-radius: 5px; 
            cursor: pointer; 
            transition: 0.3s ease-in-out; 
        }

        button:hover { 
            background: #ff1744; 
        }
    </style>
</head>
<body>

    <h1>üöó Parking Management</h1>

    <h2>Dodaj novu rezervaciju</h2>
    <label for="parkingSelect">Odaberi parking lokaciju:</label>
    <select id="parkingSelect">
        <option value="ZAGREB">ZAGREB</option>
        <option value="CRA">CRA</option>
        <option value="BLUBINI">BLUBINI</option>
    </select>

    <input type="text" id="guestName" placeholder="Ime gosta">
    <input type="text" id="carPlate" placeholder="Registarska oznaka">
    <input type="text" id="apartment" placeholder="Apartman">
    <input type="date" id="arrivalDate">
    <input type="date" id="departureDate">
    <button onclick="addReservation()">Dodaj</button>

    <h2>Zauzeƒáe parkinga</h2>
    <label for="monthSelect">Odaberi mjesec:</label>
    <select id="monthSelect" onchange="loadParking()">
        <option value="0">Sijeƒçanj</option>
        <option value="1">Veljaƒça</option>
        <option value="2">O≈æujak</option>
        <option value="3">Travanj</option>
        <option value="4">Svibanj</option>
        <option value="5">Lipanj</option>
        <option value="6">Srpanj</option>
        <option value="7">Kolovoz</option>
        <option value="8">Rujan</option>
        <option value="9">Listopad</option>
        <option value="10">Studeni</option>
        <option value="11">Prosinac</option>
    </select>

    <table id="parkingTable">
        <thead>
            <tr>
                <th>Datum</th>
                <th>Ukupno zauzeto</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        let parkingConfig = {
            ZAGREB: 7,
            CRA: 15,
            BLUBINI: 4
        };

        let parkingData = {
            ZAGREB: generateEmptyYear(7),
            CRA: generateEmptyYear(15),
            BLUBINI: generateEmptyYear(4)
        };

        function generateEmptyYear(spots) {
            let yearData = {};
            for (let month = 0; month < 12; month++) {
                yearData[month] = [];
                let daysInMonth = new Date(2025, month + 1, 0).getDate();
                for (let day = 1; day <= daysInMonth; day++) {
                    yearData[month].push(Array(spots).fill("Dostupno"));
                }
            }
            return yearData;
        }

        function loadParking() {
            const location = document.getElementById("parkingSelect").value;
            const month = parseInt(document.getElementById("monthSelect").value);
            const tableBody = document.getElementById("parkingTable").querySelector("tbody");

            tableBody.innerHTML = "";

            parkingData[location][month].forEach((day, index) => {
                let tr = document.createElement("tr");

                let dateTd = document.createElement("td");
                dateTd.innerText = `Dan ${index + 1}`;
                tr.appendChild(dateTd);

                let occupiedCount = 0;

                day.forEach((status, i) => {
                    let td = document.createElement("td");
                    td.innerText = status;
                    td.className = status === "Dostupno" ? "available" : "occupied";
                    td.onclick = () => updateReservation(location, month, index, i, td);
                    tr.appendChild(td);
                    if (status !== "Dostupno") occupiedCount++;
                });

                let summaryTd = document.createElement("td");
                summaryTd.innerText = occupiedCount;
                summaryTd.className = "summary";
                tr.appendChild(summaryTd);

                tableBody.appendChild(tr);
            });
        }

        function updateReservation(location, month, dayIndex, spotIndex, td) {
            let currentStatus = parkingData[location][month][dayIndex][spotIndex];
            if (currentStatus === "Dostupno") {
                let name = prompt("Unesite ime gosta:");
                let plate = prompt("Unesite registarsku oznaku:");
                let apartman = prompt("Unesite apartman:");
                if (name && plate && apartman) {
                    parkingData[location][month][dayIndex][spotIndex] = `${name} (${plate}, ${apartman})`;
                    td.innerText = parkingData[location][month][dayIndex][spotIndex];
                    td.className = "occupied";
                }
            } else {
                let confirmDelete = confirm("≈Ωelite li osloboditi ovo mjesto?");
                if (confirmDelete) {
                    parkingData[location][month][dayIndex][spotIndex] = "Dostupno";
                    td.innerText = "Dostupno";
                    td.className = "available";
                }
            }
        }

        function addReservation() {
            const location = document.getElementById("parkingSelect").value;
            const name = document.getElementById("guestName").value;
            const plate = document.getElementById("carPlate").value;
            const apartman = document.getElementById("apartment").value;
            const arrival = new Date(document.getElementById("arrivalDate").value);
            const departure = new Date(document.getElementById("departureDate").value);

            let startDay = arrival.getDate() - 1;
            let endDay = departure.getDate() - 1;

            for (let i = startDay; i <= endDay; i++) {
                let freeIndex = parkingData[location][arrival.getMonth()][i].indexOf("Dostupno");
                if (freeIndex !== -1) {
                    parkingData[location][arrival.getMonth()][i][freeIndex] = `${name} (${plate}, ${apartman})`;
                }
            }

            loadParking();
        }

        loadParking();
    </script>

</body>
</html>
